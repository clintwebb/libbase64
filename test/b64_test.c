#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <base64.h>


char *test_str = "VGhlcmUgYXJlIHNldmVyYWwgd2ViLWJhc2VkIEJhc2U2NCBlbmNvZGVycy9kZWNvZGVycywgYW5kIG9ubHkgYSBjb3VwbGUgSmF2YXNjcmlwdCBlbmNvZGVycy9kZWNvZGVycy4gVGhlIEphdmFzY3JpcHQgb25lcyB3ZXJlIGFsbCByYXRoZXIgY29tcGxleCAocmVsYXRpdmVseSBzcGVha2luZyksIGFuZCBub25lIHVzZWQgdGhlIGZ1bmN0aW9ucyBmb3Igd29ya2luZyB3aXRoIEJhc2U2NCB0aGF0IGFyZSBidWlsdCBpbnRvIHRoZSBKYXZhU2NyaXB0IGVuZ2luZSBpbiBOZXRzY2FwZSBDb21tdW5pY2F0b3IgNCx4IGFuZCB1cCwgYW5kIE1vemlsbGEuIFRoaXMgdXNlcyB0aG9zZSBidWlsdCBpbiBmdW5jdGlvbnMsIGFuZCBzbyBpdCBkb2Vzbid0IHdvcmsgaW4gSW50ZXJuZXQgRXhwbG9yZXIsIG9yIE9wZXJhLiA=";


/*
char *test_str = "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n8Knw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMKXTgNALsKdBsKAXDoNAMK5dBoAcsOpNADDpMOSaQDDiMKlw5MAwpBLwqcBIMOXw78Bw5bDi3RBw63CrsOGBgAAAABJRU5Ewq5CYMKC";
*/



int main(void) 
{
	int rr;
	char *full;
	int length;

	
	length = strlen(test_str)+200;
	full = malloc(length);

	printf("source length: %d\n", strlen(test_str));
	printf("buffer length: %d\n", length);

	rr = base64_decode(test_str, full, &length);

	full[length] = 0;
	printf("rr=%d\n", rr);
	printf("length=%d\n", length);
	printf("output='%s'\n", full);
//	printf("strlen(output)=%d\n", strlen(full));

	free(full);

	return 0;
}
